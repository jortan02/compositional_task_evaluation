mkdir: cannot create directory ‘/scratch/general/vast/u1283221/huggingface_cache’: File exists
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. If you see this, DO NOT PANIC! This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=True`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:42<02:50, 42.66s/it]Loading checkpoint shards:  40%|████      | 2/5 [01:36<02:27, 49.18s/it]Loading checkpoint shards:  60%|██████    | 3/5 [02:30<01:42, 51.48s/it]Loading checkpoint shards:  80%|████████  | 4/5 [03:27<00:53, 53.45s/it]Loading checkpoint shards: 100%|██████████| 5/5 [04:01<00:00, 46.66s/it]Loading checkpoint shards: 100%|██████████| 5/5 [04:01<00:00, 48.34s/it]
>> Input file: ./data/multiplication/instruction_type-1/prompt_type-1/multiply.csv, Output file: ./results/multiplication/instruction_type-1/prompt_type-1/multiply/google/flan-t5-xxl/experiment-6.csv, Module: google/flan-t5-xxl, Batch size: 100
<class 'datasets.arrow_dataset.Dataset'>
  0%|          | 0/650 [00:00<?, ?it/s]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 1912.75 examples/s]
  0%|          | 1/650 [00:06<1:05:54,  6.09s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4023.66 examples/s]
  0%|          | 2/650 [00:10<52:23,  4.85s/it]  
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6872.64 examples/s]
  0%|          | 3/650 [00:14<48:02,  4.45s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7316.97 examples/s]
  1%|          | 4/650 [00:18<46:00,  4.27s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6374.71 examples/s]
  1%|          | 5/650 [00:22<44:51,  4.17s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7065.28 examples/s]
  1%|          | 6/650 [00:26<44:10,  4.12s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6140.82 examples/s]
  1%|          | 7/650 [00:30<45:09,  4.21s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6332.36 examples/s]
  1%|          | 8/650 [00:34<45:49,  4.28s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5712.29 examples/s]
  1%|▏         | 9/650 [00:39<46:16,  4.33s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6932.39 examples/s]
  2%|▏         | 10/650 [00:43<46:32,  4.36s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5836.61 examples/s]
  2%|▏         | 11/650 [00:48<46:43,  4.39s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6282.57 examples/s]
  2%|▏         | 12/650 [00:52<46:50,  4.41s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6324.82 examples/s]
  2%|▏         | 13/650 [00:57<46:56,  4.42s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5156.38 examples/s]
  2%|▏         | 14/650 [01:01<47:00,  4.43s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5347.42 examples/s]
  2%|▏         | 15/650 [01:06<47:04,  4.45s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6630.47 examples/s]
  2%|▏         | 16/650 [01:10<47:03,  4.45s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6017.31 examples/s]
  3%|▎         | 17/650 [01:15<47:04,  4.46s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5556.40 examples/s]
  3%|▎         | 18/650 [01:19<47:03,  4.47s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6119.50 examples/s]
  3%|▎         | 19/650 [01:23<47:02,  4.47s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6395.61 examples/s]
  3%|▎         | 20/650 [01:29<49:30,  4.71s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 1831.61 examples/s]
  3%|▎         | 21/650 [01:33<48:41,  4.64s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5574.27 examples/s]
  3%|▎         | 22/650 [01:38<48:05,  4.59s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6381.40 examples/s]
  4%|▎         | 23/650 [01:43<50:09,  4.80s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4834.38 examples/s]
  4%|▎         | 24/650 [01:47<49:04,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5947.93 examples/s]
  4%|▍         | 25/650 [01:52<48:18,  4.64s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6114.86 examples/s]
  4%|▍         | 26/650 [01:56<47:42,  4.59s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6215.81 examples/s]
  4%|▍         | 27/650 [02:01<47:17,  4.56s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5887.73 examples/s]
  4%|▍         | 28/650 [02:05<47:00,  4.54s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 3274.37 examples/s]
  4%|▍         | 29/650 [02:10<46:49,  4.52s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6568.28 examples/s]
  5%|▍         | 30/650 [02:15<49:07,  4.75s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5888.64 examples/s]
  5%|▍         | 31/650 [02:20<48:09,  4.67s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6747.05 examples/s]
  5%|▍         | 32/650 [02:24<47:32,  4.62s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5604.96 examples/s]
  5%|▌         | 33/650 [02:29<47:04,  4.58s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4318.06 examples/s]
  5%|▌         | 34/650 [02:34<49:11,  4.79s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 436.01 examples/s]
  5%|▌         | 35/650 [02:39<48:52,  4.77s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5273.67 examples/s]
  6%|▌         | 36/650 [02:43<47:56,  4.68s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6065.78 examples/s]
  6%|▌         | 37/650 [02:48<47:16,  4.63s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4035.27 examples/s]
  6%|▌         | 38/650 [02:52<46:50,  4.59s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5974.62 examples/s]
  6%|▌         | 39/650 [02:57<46:29,  4.57s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5637.58 examples/s]
  6%|▌         | 40/650 [03:01<46:13,  4.55s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6037.32 examples/s]
  6%|▋         | 41/650 [03:06<45:56,  4.53s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6907.96 examples/s]
  6%|▋         | 42/650 [03:10<45:47,  4.52s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6457.94 examples/s]
  7%|▋         | 43/650 [03:15<45:39,  4.51s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6043.40 examples/s]
  7%|▋         | 44/650 [03:19<45:33,  4.51s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 3586.35 examples/s]
  7%|▋         | 45/650 [03:24<45:29,  4.51s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6822.00 examples/s]
  7%|▋         | 46/650 [03:28<45:20,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5923.07 examples/s]
  7%|▋         | 47/650 [03:33<45:14,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6120.30 examples/s]
  7%|▋         | 48/650 [03:37<45:09,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4930.70 examples/s]
  8%|▊         | 49/650 [03:42<45:06,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7291.65 examples/s]
  8%|▊         | 50/650 [03:46<45:00,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6309.41 examples/s]
  8%|▊         | 51/650 [03:51<44:49,  4.49s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6445.34 examples/s]
  8%|▊         | 52/650 [03:55<44:46,  4.49s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7037.07 examples/s]
  8%|▊         | 53/650 [04:00<44:42,  4.49s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5201.01 examples/s]
  8%|▊         | 54/650 [04:04<44:39,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5222.64 examples/s]
  8%|▊         | 55/650 [04:09<44:37,  4.50s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5821.54 examples/s]
  9%|▊         | 56/650 [04:13<44:29,  4.49s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5992.12 examples/s]
  9%|▉         | 57/650 [04:18<44:25,  4.49s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5453.74 examples/s]
  9%|▉         | 58/650 [04:22<44:55,  4.55s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6103.38 examples/s]
  9%|▉         | 59/650 [04:28<47:39,  4.84s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4546.87 examples/s]
  9%|▉         | 60/650 [04:32<47:10,  4.80s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5764.57 examples/s]
  9%|▉         | 61/650 [04:37<46:09,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4627.07 examples/s]
 10%|▉         | 62/650 [04:42<46:05,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5846.94 examples/s]
 10%|▉         | 63/650 [04:46<45:59,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6271.86 examples/s]
 10%|▉         | 64/650 [04:51<45:53,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5841.89 examples/s]
 10%|█         | 65/650 [04:56<45:14,  4.64s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6264.83 examples/s]
 10%|█         | 66/650 [05:00<44:43,  4.59s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 2241.46 examples/s]
 10%|█         | 67/650 [05:06<47:22,  4.88s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5711.66 examples/s]
 10%|█         | 68/650 [05:11<49:08,  5.07s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5299.59 examples/s]
 11%|█         | 69/650 [05:17<50:21,  5.20s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4853.11 examples/s]
 11%|█         | 70/650 [05:21<48:49,  5.05s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5311.60 examples/s]
 11%|█         | 71/650 [05:26<47:07,  4.88s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6033.93 examples/s]
 11%|█         | 72/650 [05:31<48:50,  5.07s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5709.41 examples/s]
 11%|█         | 73/650 [05:36<47:07,  4.90s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5825.50 examples/s]
 11%|█▏        | 74/650 [05:40<46:28,  4.84s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5573.38 examples/s]
 12%|█▏        | 75/650 [05:45<45:58,  4.80s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5192.83 examples/s]
 12%|█▏        | 76/650 [05:50<44:58,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6030.63 examples/s]
 12%|█▏        | 77/650 [05:54<44:54,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6274.39 examples/s]
 12%|█▏        | 78/650 [05:59<44:48,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5122.50 examples/s]
 12%|█▏        | 79/650 [06:04<44:43,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5542.60 examples/s]
 12%|█▏        | 80/650 [06:08<44:38,  4.70s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5500.58 examples/s]
 12%|█▏        | 81/650 [06:13<43:58,  4.64s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5569.46 examples/s]
 13%|█▎        | 82/650 [06:18<44:04,  4.66s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5479.67 examples/s]
 13%|█▎        | 83/650 [06:22<44:07,  4.67s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 3495.43 examples/s]
 13%|█▎        | 84/650 [06:27<44:10,  4.68s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5149.67 examples/s]
 13%|█▎        | 85/650 [06:32<44:09,  4.69s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5240.39 examples/s]
 13%|█▎        | 86/650 [06:36<43:31,  4.63s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 4091.72 examples/s]
 13%|█▎        | 87/650 [06:41<43:39,  4.65s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6166.19 examples/s]
 14%|█▎        | 88/650 [06:46<43:42,  4.67s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5708.94 examples/s]
 14%|█▎        | 89/650 [06:50<43:42,  4.68s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5394.33 examples/s]
 14%|█▍        | 90/650 [06:55<43:41,  4.68s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5488.27 examples/s]
 14%|█▍        | 91/650 [07:00<43:05,  4.62s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5164.00 examples/s]
 14%|█▍        | 92/650 [07:04<43:13,  4.65s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5575.09 examples/s]
 14%|█▍        | 93/650 [07:09<44:26,  4.79s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5615.39 examples/s]
 14%|█▍        | 94/650 [07:14<44:07,  4.76s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5191.03 examples/s]
 15%|█▍        | 95/650 [07:19<43:53,  4.74s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6033.58 examples/s]
 15%|█▍        | 96/650 [07:23<43:05,  4.67s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5284.89 examples/s]
 15%|█▍        | 97/650 [07:28<43:05,  4.68s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5810.49 examples/s]
 15%|█▌        | 98/650 [07:33<43:04,  4.68s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6351.93 examples/s]
 15%|█▌        | 99/650 [07:37<43:01,  4.69s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6245.71 examples/s]
 15%|█▌        | 100/650 [07:42<42:26,  4.63s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6194.33 examples/s]
 16%|█▌        | 101/650 [07:47<42:32,  4.65s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5959.93 examples/s]
 16%|█▌        | 102/650 [07:52<43:43,  4.79s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5929.94 examples/s]
 16%|█▌        | 103/650 [07:56<43:24,  4.76s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6104.71 examples/s]
 16%|█▌        | 104/650 [08:01<43:09,  4.74s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5861.16 examples/s]
 16%|█▌        | 105/650 [08:06<42:57,  4.73s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6932.39 examples/s]
 16%|█▋        | 106/650 [08:11<43:54,  4.84s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5986.22 examples/s]
 16%|█▋        | 107/650 [08:16<44:32,  4.92s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6904.20 examples/s]
 17%|█▋        | 108/650 [08:21<43:50,  4.85s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5979.48 examples/s]
 17%|█▋        | 109/650 [08:26<44:27,  4.93s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5887.40 examples/s]
 17%|█▋        | 110/650 [08:30<43:45,  4.86s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7139.36 examples/s]
 17%|█▋        | 111/650 [08:36<44:09,  4.92s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5594.12 examples/s]
 17%|█▋        | 112/650 [08:40<44:14,  4.93s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6167.01 examples/s]
 17%|█▋        | 113/650 [08:46<45:20,  5.07s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5727.97 examples/s]
 18%|█▊        | 114/650 [08:51<46:05,  5.16s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 3817.34 examples/s]
 18%|█▊        | 115/650 [08:57<46:36,  5.23s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7295.71 examples/s]
 18%|█▊        | 116/650 [09:02<45:48,  5.15s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 5509.69 examples/s]
 18%|█▊        | 117/650 [09:07<46:21,  5.22s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 7558.53 examples/s]
 18%|█▊        | 118/650 [09:15<52:26,  5.92s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6674.36 examples/s]
 18%|█▊        | 119/650 [09:20<50:55,  5.75s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6301.07 examples/s]
 18%|█▊        | 120/650 [09:25<49:49,  5.64s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6341.65 examples/s]
 19%|█▊        | 121/650 [09:31<49:05,  5.57s/it]
Map:   0%|          | 0/100 [00:00<?, ? examples/s][AMap: 100%|██████████| 100/100 [00:00<00:00, 6830.34 examples/s]
 19%|█▊        | 121/650 [09:39<42:13,  4.79s/it]
Traceback (most recent call last):
  File "/uufs/chpc.utah.edu/common/home/u1283221/compositional_task_evaluation/t5_cte.py", line 18, in <module>
    run_experiment.run_experiment(model, tokenizer, batch_size, input_file_path, output_file_path)
  File "/uufs/chpc.utah.edu/common/home/u1283221/compositional_task_evaluation/run_experiment.py", line 54, in run_experiment
    predictions = _evaluate_model(model, tokenizer, dataset, batch_size)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/compositional_task_evaluation/run_experiment.py", line 41, in _evaluate_model
    generated_texts = _generate_texts(model, tokenizer, encodings)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/compositional_task_evaluation/run_experiment.py", line 31, in _generate_texts
    generated_ids = model.generate(**encodings, max_new_tokens=20, num_beams=5, do_sample=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/generation/utils.py", line 1712, in generate
    return self.beam_sample(
           ^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/generation/utils.py", line 3338, in beam_sample
    outputs = self(
              ^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 1746, in forward
    decoder_outputs = self.decoder(
                      ^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 1123, in forward
    layer_outputs = layer_module(
                    ^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 695, in forward
    self_attention_outputs = self.layer[0](
                             ^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 602, in forward
    attention_output = self.SelfAttention(
                       ^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 527, in forward
    value_states = project(
                   ^^^^^^^^
  File "/uufs/chpc.utah.edu/common/home/u1283221/miniconda3/envs/compositional/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 508, in project
    hidden_states = torch.cat([past_key_value, hidden_states], dim=2)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 110.00 MiB (GPU 0; 79.15 GiB total capacity; 72.16 GiB already allocated; 33.25 MiB free; 78.62 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
